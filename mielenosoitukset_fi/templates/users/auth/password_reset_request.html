{% extends 'base.html' %}
{% block styles %}
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
<link rel="stylesheet" href="{{ url_for('static', filename='css/v2/auth.css') }}">
{% endblock %}

{% block content %}
<div class="auth-wrapper">
  <div class="auth-container">
    <div class="auth-header">
      <div class="auth-icon">
        <i class="fa-solid fa-key"></i>
      </div>
      <h1>{{ _('Unohtuiko salasanasi?') }}</h1>
      <p class="auth-subtitle">{{ _('Syötä sähköpostiosoitteesi, niin lähetämme sinulle salasanan palautusohjeet') }}</p>
    </div>

    <div id="success-message" class="hidden"></div>
    <div id="error-message" class="hidden"></div>

    <form method="POST" id="reset-request-form">
      <div class="form-group">
        <label class="form-label" for="email">
          <i class="fa-solid fa-envelope"></i>
          {{ _('Sähköpostiosoite') }}
        </label>
        <div class="form-input-wrapper">
          <i class="fa-solid fa-envelope form-input-icon"></i>
          <input type="email" 
                 id="email" 
                 name="email" 
                 class="form-input" 
                 placeholder="{{ _('nimi@esimerkki.fi') }}"
                 required 
                 autocomplete="email">
        </div>
        <p class="form-hint">
          <i class="fa-solid fa-circle-info"></i>
          {{ _('Käytä mielenosoitukset.fi -palvelussa käyttämääsi sähköpostiosoitetta') }}
        </p>
      </div>

      <button type="submit" class="btn btn-primary" id="submit-btn">
        <i class="fa-solid fa-paper-plane"></i>
        {{ _('Lähetä palautuslinkki') }}
      </button>
    </form>

    <div class="auth-divider">
      <span>{{ _('tai') }}</span>
    </div>

    <div class="register-prompt">
      <p>{{ _('Muistitko salasanasi?') }}</p>
      <a href="{{ url_for('users.auth.login') }}" class="btn btn-secondary">
        <i class="fa-solid fa-arrow-left"></i>
        {{ _('Takaisin kirjautumiseen') }}
      </a>
    </div>

    <div class="auth-footer">
      <p class="help-text">
        <i class="fa-solid fa-shield-halved"></i>
        {{ _('Saat sähköpostin muutaman minuutin sisällä, jos tilisi on olemassa') }}
      </p>
    </div>
  </div>
</div>

<script>
// Show success message
function showSuccess(message) {
  const successDiv = document.getElementById('success-message');
  successDiv.className = 'alert alert-success';
  successDiv.innerHTML = `
    <i class="fa-solid fa-circle-check"></i>
    <span>${message}</span>
  `;
  successDiv.classList.remove('hidden');
  successDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
}

// Show error message
function showError(message) {
  const errorDiv = document.getElementById('error-message');
  errorDiv.className = 'alert alert-error';
  errorDiv.innerHTML = `
    <i class="fa-solid fa-triangle-exclamation"></i>
    <span>${message}</span>
  `;
  errorDiv.classList.remove('hidden');
  errorDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
}

// Form submission
document.getElementById('reset-request-form').addEventListener('submit', function(event) {
  const submitBtn = document.getElementById('submit-btn');
  
  // Add loading state
  submitBtn.classList.add('loading');
  submitBtn.disabled = true;
  
  // Hide previous messages
  document.getElementById('success-message').classList.add('hidden');
  document.getElementById('error-message').classList.add('hidden');
});

// Focus on email input on page load
document.addEventListener('DOMContentLoaded', function() {
  document.getElementById('email').focus();
});
</script>
{% endblock %}