{% extends 'base.html' %}
{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/submit.css') }}" />
<!-- Include Flatpickr CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

<!-- Include Flatpickr JS -->
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

<div class="container container-main-content">
  <h1>Ilmoita mielenosoituksesta</h1>

  <form method="POST" action="{{ url_for('submit') }}" class="container-form" enctype="multipart/form-data">
    <!-- Name -->
    <label for="name" class="required">Mielenosoituksen nimi<span class="required-asterisk">*</span></label>
    <input type="text" id="name" name="title" placeholder="Mielenosoituksen nimi" required />

    <!-- Tag (Aihe) -->
    <label for="topic" class="required">Aihe<span class="required-asterisk">*</span></label>
    <input type="text" id="topic" name="topic" placeholder="Aihe" required />

    <!-- Date -->
    <label for="date" class="required">Päivämäärä (pp.kk.vvvv)<span class="required-asterisk">*</span></label>
    <input type="text" id="date" name="date" placeholder="pp.kk.vvvv" required />

    <!-- Start and End Time -->
    <label for="start_time" class="required">Alkamisaika<span class="required-asterisk">*</span></label>
    <input type="time" id="start_time" name="start_time" required />
    <label for="end_time">Päättymisaika</label>
    <input type="time" id="end_time" name="end_time" />

    <!-- Image Upload -->
    <label for="image">Kuva (valinnainen)</label>
    <input type="file" id="image" name="image" accept="image/*" />

    <!-- Additional Information -->
    <label for="facebook">Facebook-tapahtumalinkki (valinnainen)</label>
    <input type="url" id="facebook" name="facebook" placeholder="https://facebook.com/event" />

    <!-- Organizers -->
    <label for="organizers" class="required">Järjestäjä(t)<span class="required-asterisk">*</span></label>
    <div id="organizers-container"></div>
    <button type="button" class="add-organizer-button" onclick="addOrganizer()">Lisää järjestäjä</button>

    <!-- Location Type -->
    <label for="type" class="required">Mielenosoituksen tyyppi<span class="required-asterisk">*</span></label>
    <select id="type" name="type" required>
      <option value="" disabled selected>Valitse mielenosoituksen tyyppi</option>
      <option value="paikallaan">Paikallaan</option>
      <option value="marssi">Marssi</option>
      <option value="muut">Muut</option>
    </select>

    <div id="march-route-container" class="optional-section">
      <label for="route">Reitti (vain marssille, valinnainen)</label>
      <textarea id="route" name="route" placeholder="Reitti..."></textarea>
    </div>

    <!-- Include Paikkakunta Dropdown -->
    {% include "paikkakunta-dropdown.html" %}

    <label for="address" class="required">Katuosoite<span class="required-asterisk">*</span></label>
    <input type="text" id="address" name="address" placeholder="Katuosoite" required />

    <button type="submit" class="submit-button">Lähetä</button>
  </form>
</div>

<script>
  let organizerCount = 0;

  function addOrganizer() {
    organizerCount++;
    const container = document.getElementById("organizers-container");
    const organizerDiv = document.createElement("div");
    organizerDiv.className = "organizer";

    organizerDiv.innerHTML = `
      <div class="organizer-entry">
        <hr>
        <p>Järjestäjätahon...</p>
        <label for="organizer_name_${organizerCount}">Nimi<span class="required-asterisk">*</span></label>
        <input type="text" id="organizer_name_${organizerCount}" name="organizer_name_${organizerCount}" placeholder="Järjestäjän nimi" required>

        <label for="organizer_website_${organizerCount}">Verkkosivut</label>
        <input type="url" id="organizer_website_${organizerCount}" name="organizer_website_${organizerCount}" placeholder="https://example.com">

        <label for="organizer_email_${organizerCount}">Sähköpostiosoite</label>
        <input type="email" id="organizer_email_${organizerCount}" name="organizer_email_${organizerCount}" placeholder="sähköposti@example.com">
      </div>
    `;

    container.appendChild(organizerDiv);
  }

  document.getElementById("type").addEventListener("change", function () {
    var marchRouteContainer = document.getElementById("march-route-container");
    if (this.value === "marssi") {
      marchRouteContainer.style.display = "block";
    } else {
      marchRouteContainer.style.display = "none";
    }
  });
</script>

<style>
  .required {
    color: #333;
  }
  .required-asterisk {
    color: red;
    margin-left: 5px;
  }
  .optional-section {
    display: none;
  }
</style>
<script src="{{ url_for('static', filename='js/date.js') }}"></script>

{% endblock %}
